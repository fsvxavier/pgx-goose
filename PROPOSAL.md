# üöÄ Status de Implementa√ß√£o: PGX-Goose v2.0

![Status](https://img.shields.io/badge/Status-IMPLEMENTADO-success.svg)
![Progress](https://img.shields.io/badge/Progress-100%25-brightgreen.svg)
![Version](https://img.shields.io/badge/Version-v2.0+-blue.svg)
![Go](https://img.shields.io/badge/Go-1.23+-00ADD8.svg)

**Data de Atualiza√ß√£o:** 7 de julho de 2025  
**Autor:** Equipe de Desenvolvimento  
**Status:** ‚úÖ **IMPLEMENTADO** - Funcionalidades Core Conclu√≠das  
**Vers√£o:** v2.0+ (Todas as funcionalidades core implementadas)  

## üìã Sum√°rio Executivo - Status Atual

‚úÖ **SUCESSO:** O PGX-Goose evoluiu com **sucesso** de uma ferramenta especializada para uma **su√≠te completa de ferramentas de desenvolvimento** para projetos Go + PostgreSQL, mantendo 100% de compatibilidade com vers√µes anteriores.

### üéØ Objetivos Alcan√ßados
‚úÖ Plataforma unificada que automatiza o pipeline de desenvolvimento backend  
‚úÖ Filosofia de Clean Architecture mantida  
‚úÖ Integra√ß√£o completa com `nexs-lib`  
‚úÖ Sistema multi-comando implementado  
‚úÖ Configura√ß√£o hier√°rquica funcional  

### üóÇÔ∏è Navega√ß√£o R√°pida
- [üèóÔ∏è **I. Core Features - Status de Implementa√ß√£o**](#Ô∏è-i-core-features---status-de-implementa√ß√£o)
  - [1.1 Sistema de Configura√ß√£o Avan√ßada](#11-sistema-de-configura√ß√£o-avan√ßada--implementado-completamente)
  - [1.2 CLI Multi-Comando](#12-cli-multi-comando--implementado-completamente)
  - [1.3 Sistema de Gera√ß√£o Avan√ßado](#13-sistema-de-gera√ß√£o-avan√ßado--implementado-completamente)
- [üé® **II. Pr√≥ximas Funcionalidades - Roadmap Futuro**](#-ii-pr√≥ximas-funcionalidades---roadmap-futuro)
- [üéØ **III. Status Final - Resultados Alcan√ßados**](#-iii-status-final---resultados-alcan√ßados)
- [üìñ **IV. Exemplos Pr√°ticos de Uso**](#-iv-exemplos-pr√°ticos-de-uso)

### üìä Status de Implementa√ß√£o vs Proposta Original

| **Aspecto** | **Status Proposto** | **Status Atual** | **‚úÖ Implementado** |
|-------------|---------------------|------------------|-------------------|
| Arquitetura | Multi-comando + backward compatible | ‚úÖ **IMPLEMENTADO** | CLI com m√∫ltiplas funcionalidades |
| Configura√ß√£o | Configura√ß√£o hier√°rquica | ‚úÖ **IMPLEMENTADO** | YAML/JSON + diret√≥rios separados |
| Gera√ß√£o Paralela | Sistema paralelo avan√ßado | ‚úÖ **IMPLEMENTADO** | Workers configur√°veis |
| Otimiza√ß√£o Templates | Cache e pr√©-compila√ß√£o | ‚úÖ **IMPLEMENTADO** | Sistema de cache ativo |
| Cross-Schema | Relacionamentos multi-schema | ‚úÖ **IMPLEMENTADO** | Detec√ß√£o autom√°tica |
| Gera√ß√£o Incremental | Delta generation | ‚úÖ **IMPLEMENTADO** | Force + cache intelligente |
| Go Generate | Integra√ß√£o autom√°tica | ‚úÖ **IMPLEMENTADO** | Diretivas autom√°ticas |
| Migra√ß√µes | Gera√ß√£o de migrations | ‚úÖ **IMPLEMENTADO** | Formato Goose |

---

## üèóÔ∏è I. Core Features - Status de Implementa√ß√£o

### 1.1 Sistema de Configura√ß√£o Avan√ßada ‚úÖ **IMPLEMENTADO COMPLETAMENTE**

**‚úÖ SUCESSO:** Sistema de configura√ß√£o hier√°rquica com suporte completo a YAML/JSON implementado.

#### Configura√ß√£o Atual Implementada
```yaml
# pgx-goose-conf.yaml - Configura√ß√£o principal
dsn: "postgres://..."
schema: "public"  
out: "./generated"  # Backward compatibility mantida

# ‚úÖ IMPLEMENTADO: Configura√ß√£o de diret√≥rios separados
output_dirs:
  base: "./generated"                       # Diret√≥rio base
  models: "./generated/src/domain/entities"          # Modelos/entidades
  interfaces: "./generated/src/ports/repositories"   # Interfaces dos reposit√≥rios  
  repositories: "./generated/src/adapters/db"        # Implementa√ß√µes PostgreSQL
  mocks: "./generated/tests/mocks"                   # Mocks para testes
  tests: "./generated/tests/integration"             # Testes integrados

# ‚úÖ IMPLEMENTADO: Op√ß√µes de gera√ß√£o avan√ßadas
mock_provider: "mock"        # mock ou testify
with_tests: true            # Gerar testes automaticamente
template_dir: "./templates" # Templates personalizados

# ‚úÖ IMPLEMENTADO: Filtros de tabelas
tables: []                  # Tabelas espec√≠ficas (vazio = todas)
ignore_tables:              # Tabelas para ignorar
  - "schema_migrations"
  - "goose_db_version"

# ‚úÖ IMPLEMENTADO: Configura√ß√µes avan√ßadas
parallel:
  enabled: true             # Gera√ß√£o paralela
  workers: 4               # N√∫mero de workers

template_optimization:
  enabled: true            # Cache de templates
  cache_size: 100         # Tamanho do cache
  precompile: true        # Pr√©-compila√ß√£o

incremental:
  enabled: true           # Gera√ß√£o incremental
  force: false           # For√ßar regenera√ß√£o completa

cross_schema:
  enabled: true                      # Cross-schema support
  schemas: ["public", "analytics"]   # Schemas a incluir
  relationship_detection: true       # Detectar relacionamentos

migrations:
  enabled: true                 # Gerar migra√ß√µes
  output_dir: "./migrations"   # Diret√≥rio de sa√≠da
  format: "goose"             # Formato das migra√ß√µes

go_generate:
  enabled: true              # Integra√ß√£o go:generate
  create_directive: true     # Criar diretiva
  update_makefile: true     # Atualizar Makefile
  update_vscode_tasks: true # Atualizar VS Code tasks
```
### 1.2 CLI Multi-Comando ‚úÖ **IMPLEMENTADO COMPLETAMENTE**

**‚úÖ SUCESSO:** Arquitetura CLI expandida mantendo 100% de backward compatibility.

#### Comandos Implementados
```bash
# ‚úÖ MANTIDO: Backward compatibility (100% funcional)
pgx-goose --dsn "..." --schema "..." --out "./generated"

# ‚úÖ IMPLEMENTADO: Funcionalidades avan√ßadas via flags
pgx-goose --config pgx-goose-conf.yaml                    # Configura√ß√£o por arquivo
pgx-goose --parallel --workers 4                          # Gera√ß√£o paralela
pgx-goose --incremental                                    # Gera√ß√£o incremental
pgx-goose --force                                         # For√ßar regenera√ß√£o
pgx-goose --cross-schema                                  # Cross-schema support
pgx-goose --generate-migrations                           # Gerar migra√ß√µes
pgx-goose --go-generate                                   # Integra√ß√£o go:generate
pgx-goose --optimize-templates                            # Otimiza√ß√£o de templates

# ‚úÖ IMPLEMENTADO: Configura√ß√£o granular
pgx-goose --models-dir "./entities" \
          --interfaces-dir "./ports" \
          --repos-dir "./adapters" \
          --mocks-dir "./mocks" \
          --tests-dir "./tests"

# ‚úÖ IMPLEMENTADO: Filtros avan√ßados
pgx-goose --tables users,orders \
          --mock-provider mock \
          --template-dir "./custom-templates"
```

### 1.3 Sistema de Gera√ß√£o Avan√ßado ‚úÖ **IMPLEMENTADO COMPLETAMENTE**

**‚úÖ SUCESSO:** Implementa√ß√£o completa de todas as funcionalidades core propostas.

#### Funcionalidades Implementadas

**üîÑ Gera√ß√£o Paralela:**
```go
// ‚úÖ IMPLEMENTADO: internal/generator/parallel.go
type ParallelGenerator struct {
    workers     int
    semaphore   chan struct{}
    wg          sync.WaitGroup
    rateLimiter *time.Ticker
}

func (pg *ParallelGenerator) GenerateParallel(tables []introspector.Table) error {
    // Worker pool implementado
    // Rate limiting ativo
    // Controle de concorr√™ncia
}
```

**‚ö° Otimiza√ß√£o de Templates:**
```go
// ‚úÖ IMPLEMENTADO: internal/generator/template_optimizer.go
type TemplateOptimizer struct {
    cache     map[string]*template.Template
    cacheSize int
    hits      int64
    misses    int64
}

func (to *TemplateOptimizer) OptimizeAndCache(tmpl *template.Template) {
    // Cache LRU implementado
    // Pr√©-compila√ß√£o ativa
    // M√©tricas de performance
}
```

**üîÑ Gera√ß√£o Incremental:**
```go
// ‚úÖ IMPLEMENTADO: internal/generator/incremental.go
type IncrementalGenerator struct {
    checksumCache map[string]string
    forceRegenerate bool
}

func (ig *IncrementalGenerator) ShouldRegenerate(table introspector.Table) bool {
    // Checksum de tabelas
    // Cache inteligente
    // Force override
}
```

**üîó Cross-Schema Support:**
```go
// ‚úÖ IMPLEMENTADO: internal/generator/cross_schema.go
type CrossSchemaAnalyzer struct {
    schemas []string
    relationships map[string][]Relationship
}

func (csa *CrossSchemaAnalyzer) AnalyzeRelationships() error {
    // Detec√ß√£o autom√°tica de FKs
    // Relacionamentos cross-schema
    // Gera√ß√£o de joins
}
```

---

## üé® II. Pr√≥ximas Funcionalidades - Roadmap Futuro

### 2.1 Gera√ß√£o TypeScript ‚è≥ **PR√ìXIMA IMPLEMENTA√á√ÉO**

**Pr√≥ximo Objetivo:** Expandir para gera√ß√£o completa de tipos TypeScript para integra√ß√£o frontend.

#### Proposta para Configura√ß√£o TypeScript
```yaml
# frontend.yaml - Configura√ß√£o para gera√ß√£o TypeScript (FUTURA)
gen_typescript:
  - name: "api-types"
    path: "internal/models"                    # Diret√≥rio Go source
    output_dir: "frontend/src/types"           # Sa√≠da TypeScript
    output_file_name: "api-types.d.ts"
    
    # Configura√ß√µes de c√≥digo
    prettier_code: true
    eslint_compatible: true
    export_type_prefix: "Api"
    export_interface_suffix: ""
    
    # Filtros de structs
    include_struct_names_regexp:
      - "^\\w*Request$"
      - "^\\w*Response$"
      - "^\\w*DTO$"
    exclude_struct_names:
      - "InternalConfig"
      - "DatabaseConfig"
    
    # Mapeamento de tipos
    type_mappings:
      "time.Time": "string"              # ISO 8601
      "decimal.Decimal": "string"        # Preserva precis√£o
      "uuid.UUID": "string"
      "json.RawMessage": "any"
      "[]byte": "string"                 # Base64
    
    # Op√ß√µes avan√ßadas
    generate_validators: true            # Fun√ß√µes de valida√ß√£o
    generate_converters: true            # Fun√ß√µes de convers√£o
    include_json_tags: true              # Respeita tags JSON
    null_safety: true                    # Tipos nullables
    
  - name: "database-types"
    path: "internal/generated/models"    # Modelos do banco
    output_dir: "frontend/src/types"
    output_file_name: "database-types.d.ts"
    export_type_prefix: "DB"
    include_all_structs: true
    generate_table_schemas: true         # Schemas de tabelas
```

#### Sa√≠da TypeScript Gerada
```typescript
// frontend/src/types/api-types.d.ts
/**
 * Generated by PGX-Goose v2.0
 * DO NOT EDIT - This file is automatically generated
 * Source: internal/models
 */

// === Request Types ===
export interface ApiCreateUserRequest {
  email: string;
  name: string;
  profile?: {
    bio?: string;
    avatar_url?: string;
  };
}

export interface ApiUpdateUserRequest {
  user_id: number;
  email?: string;
  name?: string;
  profile?: Partial<ApiUserProfile>;
}

export interface ApiFindUsersRequest {
  limit?: number;
  offset?: number;
  status?: 'active' | 'inactive' | 'pending';
  search?: string;
  order_by?: 'created_at' | 'name' | 'email';
  order_direction?: 'ASC' | 'DESC';
}

// === Response Types ===
export interface ApiUserResponse {
  user_id: number;
  email: string;
  name: string;
  status: 'active' | 'inactive' | 'pending';
  created_at: string;        // ISO 8601
  updated_at: string;        // ISO 8601
  deleted_at: string | null; // ISO 8601 or null
  profile?: ApiUserProfile;
}

export interface ApiUserProfile {
  profile_id: number;
  user_id: number;
  bio: string | null;
  avatar_url: string | null;
  settings: Record<string, any>; // JSON object
}

export interface ApiPaginatedUsersResponse {
  data: ApiUserResponse[];
  pagination: {
    total: number;
    limit: number;
    offset: number;
    has_more: boolean;
  };
}

// === Utility Types ===
export type ApiUserCreateData = Omit<ApiUserResponse, 'user_id' | 'created_at' | 'updated_at' | 'deleted_at'>;
export type ApiUserUpdateData = Partial<ApiUserCreateData>;

// === Validators (Optional) ===
export function isValidApiUserResponse(obj: any): obj is ApiUserResponse {
  return obj && 
    typeof obj.user_id === 'number' &&
    typeof obj.email === 'string' &&
    typeof obj.name === 'string' &&
    ['active', 'inactive', 'pending'].includes(obj.status) &&
    typeof obj.created_at === 'string';
}

// === Type Guards ===
export function isApiUserResponse(obj: unknown): obj is ApiUserResponse {
  return isValidApiUserResponse(obj);
}
```

### 2.2 Sistema de Constantes Unificado üî• **PRIORIDADE M√âDIA**

**Problema Identificado:** Hardcoded strings para nomes de tabelas, colunas e valores, causando inconsist√™ncias e dificultando manuten√ß√£o.

**Solu√ß√£o Proposta:**

#### Configura√ß√£o de Constantes
```yaml
# constants.yaml - Configura√ß√£o para gera√ß√£o de constantes
constants:
  output_dir: "internal/constants"
  package_name: "constants"
  
  # Constantes de tabelas
  tables:
    users:
      include_table_name: true
      include_column_names: true
      include_enum_values: true
      enum_columns:
        status: ["active", "inactive", "pending", "deleted"]
        role: ["admin", "user", "moderator"]
    
    orders:
      include_table_name: true
      include_column_names: true
      include_enum_values: true
      enum_columns:
        status: ["pending", "processing", "shipped", "delivered", "cancelled"]
        payment_status: ["pending", "paid", "failed", "refunded"]
  
  # Constantes personalizadas
  custom:
    - name: "Limits"
      values:
        MAX_UPLOAD_SIZE: 10485760  # 10MB
        MAX_USERNAME_LENGTH: 50
        MIN_PASSWORD_LENGTH: 8
        SESSION_TIMEOUT: 3600      # 1 hour
    
    - name: "Messages"
      values:
        USER_NOT_FOUND: "User not found"
        INVALID_CREDENTIALS: "Invalid credentials"
        ACCESS_DENIED: "Access denied"
  
  # Gera√ß√£o TypeScript correspondente
  generate_typescript: true
  typescript_output: "frontend/src/constants"
```

#### Sa√≠da Go Gerada
```go
// internal/constants/tables.go
package constants

// Table names
const (
    UsersTable  = "users"
    OrdersTable = "orders"
)

// Users table columns
const (
    UsersColUserID    = "user_id"
    UsersColEmail     = "email"
    UsersColName      = "name"
    UsersColStatus    = "status"
    UsersColRole      = "role"
    UsersColCreatedAt = "created_at"
    UsersColUpdatedAt = "updated_at"
    UsersColDeletedAt = "deleted_at"
)

// Users enum values
const (
    UsersStatusActive   = "active"
    UsersStatusInactive = "inactive"
    UsersStatusPending  = "pending"
    UsersStatusDeleted  = "deleted"
    
    UsersRoleAdmin     = "admin"
    UsersRoleUser      = "user"
    UsersRoleModerator = "moderator"
)

// Orders table columns
const (
    OrdersColOrderID       = "order_id"
    OrdersColUserID        = "user_id"
    OrdersColTotal         = "total"
    OrdersColStatus        = "status"
    OrdersColPaymentStatus = "payment_status"
    OrdersColCreatedAt     = "created_at"
    OrdersColUpdatedAt     = "updated_at"
)

// Orders enum values
const (
    OrdersStatusPending    = "pending"
    OrdersStatusProcessing = "processing"
    OrdersStatusShipped    = "shipped"
    OrdersStatusDelivered  = "delivered"
    OrdersStatusCancelled  = "cancelled"
    
    OrdersPaymentStatusPending  = "pending"
    OrdersPaymentStatusPaid     = "paid"
    OrdersPaymentStatusFailed   = "failed"
    OrdersPaymentStatusRefunded = "refunded"
)

// internal/constants/limits.go
package constants

const (
    MaxUploadSize      = 10485760 // 10MB
    MaxUsernameLength  = 50
    MinPasswordLength  = 8
    SessionTimeout     = 3600     // 1 hour
)

// internal/constants/messages.go
package constants

const (
    UserNotFound       = "User not found"
    InvalidCredentials = "Invalid credentials"
    AccessDenied       = "Access denied"
)
```

#### Sa√≠da TypeScript Correspondente
```typescript
// frontend/src/constants/tables.ts
// Generated by PGX-Goose v2.0 - DO NOT EDIT

// Table names
export const TABLES = {
  USERS: 'users',
  ORDERS: 'orders',
} as const;

// Users table
export const USERS_COLUMNS = {
  USER_ID: 'user_id',
  EMAIL: 'email',
  NAME: 'name',
  STATUS: 'status',
  ROLE: 'role',
  CREATED_AT: 'created_at',
  UPDATED_AT: 'updated_at',
  DELETED_AT: 'deleted_at',
} as const;

export const USERS_STATUS = {
  ACTIVE: 'active',
  INACTIVE: 'inactive',
  PENDING: 'pending',
  DELETED: 'deleted',
} as const;

export const USERS_ROLE = {
  ADMIN: 'admin',
  USER: 'user',
  MODERATOR: 'moderator',
} as const;

// Type definitions
export type UsersStatus = typeof USERS_STATUS[keyof typeof USERS_STATUS];
export type UsersRole = typeof USERS_ROLE[keyof typeof USERS_ROLE];

// frontend/src/constants/limits.ts
export const LIMITS = {
  MAX_UPLOAD_SIZE: 10485760,      // 10MB
  MAX_USERNAME_LENGTH: 50,
  MIN_PASSWORD_LENGTH: 8,
  SESSION_TIMEOUT: 3600,          // 1 hour
} as const;

// frontend/src/constants/messages.ts
export const MESSAGES = {
  USER_NOT_FOUND: 'User not found',
  INVALID_CREDENTIALS: 'Invalid credentials',
  ACCESS_DENIED: 'Access denied',
} as const;
```

**Benef√≠cios da Frontend Integration:**
- üõ°Ô∏è **Type Safety:** Elimina√ß√£o completa de bugs de tipo entre backend-frontend
- üîÑ **Sincroniza√ß√£o:** Constantes sempre sincronizadas entre Go e TypeScript
- üìù **Manuten√ß√£o:** Mudan√ßas de schema refletidas automaticamente no frontend
- ‚ö° **Produtividade:** Autocompletar e valida√ß√£o em tempo de desenvolvimento
- üèóÔ∏è **Arquitetura:** Separa√ß√£o clara entre tipos de API e tipos de banco

---

## üõ†Ô∏è III. Developer Experience - UX e Auto-Update

### 3.1 Sistema de Auto-Update Inteligente üî• **PRIORIDADE ALTA**

**Problema Identificado:** Desenvolvedores ficam com vers√µes desatualizadas, perdendo novos recursos e corre√ß√µes de bugs.

**Solu√ß√£o Proposta:**

#### Configura√ß√£o Auto-Update
```yaml
# .pgx-goose/config.yaml - Configura√ß√£o local do usu√°rio
update:
  auto_check: true                    # Verificar automaticamente
  check_interval: "24h"               # Frequ√™ncia de verifica√ß√£o
  notify_only: false                  # true = apenas notificar, false = perguntar para atualizar
  include_prereleases: false          # Incluir vers√µes beta/rc
  backup_current: true                # Backup antes de atualizar
  
  # Canais de atualiza√ß√£o
  channel: "stable"                   # stable, beta, alpha
  
  # Configura√ß√µes de seguran√ßa
  verify_signatures: true             # Verificar assinatura digital
  download_timeout: "5m"              # Timeout para download
  
  # Notifica√ß√µes
  notifications:
    desktop: true                     # Notifica√ß√£o no desktop
    terminal: true                    # Notifica√ß√£o no terminal
    webhooks:                         # Webhooks para integra√ß√£o
      - url: "https://api.slack.com/..."
        on: ["major", "security"]     # Tipos de update
```

#### Implementa√ß√£o Auto-Update
```bash
# Verifica√ß√£o manual
pgx-goose update --check
# ‚úÖ New version available: v2.1.0 (current: v2.0.5)
# ‚úÖ Release notes: https://github.com/user/pgx-goose/releases/tag/v2.1.0
# ‚úÖ Security fixes: CVE-2024-001, CVE-2024-002
# 
# Update now? [Y/n]: Y

# Atualiza√ß√£o autom√°tica com backup
pgx-goose update --auto --backup
# ‚¨áÔ∏è  Downloading PGX-Goose v2.1.0...
# üíæ Creating backup of current version...
# ‚úÖ Backup saved to: ~/.pgx-goose/backups/v2.0.5/
# üîß Installing new version...
# ‚úÖ pgx-goose updated successfully!
# üß™ Running post-update validation...
# ‚úÖ All systems operational

# Rollback se necess√°rio
pgx-goose update --rollback --to v2.0.5
# üîÑ Rolling back to v2.0.5...
# ‚úÖ Rollback completed successfully

# Status de atualiza√ß√£o
pgx-goose update --status
# Current version: v2.1.0
# Latest stable: v2.1.0 ‚úÖ
# Latest beta: v2.2.0-beta.1
# Auto-update: enabled (daily check)
# Last check: 2 hours ago
```

### 3.2 Scripts de Instala√ß√£o Universal

**Script Bash Inteligente:**
```bash
#!/bin/bash
# install.sh - Instala√ß√£o universal do pgx-goose

set -euo pipefail

# Detec√ß√£o autom√°tica de plataforma
detect_platform() {
    local os=$(uname -s | tr '[:upper:]' '[:lower:]')
    local arch=$(uname -m)
    
    case "$os" in
        linux*)   OS="linux" ;;
        darwin*)  OS="darwin" ;;
        msys*|cygwin*|mingw*) OS="windows" ;;
        *) echo "‚ùå Unsupported OS: $os" >&2; exit 1 ;;
    esac
    
    case "$arch" in
        x86_64|amd64) ARCH="amd64" ;;
        arm64|aarch64) ARCH="arm64" ;;
        armv7l) ARCH="arm" ;;
        *) echo "‚ùå Unsupported architecture: $arch" >&2; exit 1 ;;
    esac
}

# Instala√ß√£o com verifica√ß√£o
install_pgxgoose() {
    local version="${1:-latest}"
    local install_dir="${2:-/usr/local/bin}"
    
    echo "üöÄ Installing pgx-goose $version for $OS/$ARCH..."
    
    # Download com verifica√ß√£o de integridade
    local url="https://github.com/user/pgx-goose/releases/download/$version/pgx-goose_${OS}_${ARCH}.tar.gz"
    local temp_dir=$(mktemp -d)
    
    curl -fsSL "$url" -o "$temp_dir/pgx-goose.tar.gz"
    curl -fsSL "$url.sha256" -o "$temp_dir/pgx-goose.tar.gz.sha256"
    
    # Verificar checksum
    cd "$temp_dir"
    sha256sum -c pgx-goose.tar.gz.sha256
    
    # Extrair e instalar
    tar -xzf pgx-goose.tar.gz
    sudo mv pgx-goose "$install_dir/"
    sudo chmod +x "$install_dir/pgx-goose"
    
    # Verificar instala√ß√£o
    echo "‚úÖ Installation completed!"
    echo "üìç Installed to: $install_dir/pgx-goose"
    echo "üîß Version: $(pgx-goose --version)"
    
    # Configurar auto-update
    read -p "ü§î Enable auto-update? [Y/n]: " -n 1 -r
    echo
    if [[ $REPLY =~ ^[Yy]$ ]]; then
        pgx-goose update --setup-auto
        echo "‚úÖ Auto-update enabled"
    fi
    
    cleanup
}

# Exemplo de uso
# curl -fsSL https://raw.githubusercontent.com/user/pgx-goose/main/install.sh | bash
# curl -fsSL https://raw.githubusercontent.com/user/pgx-goose/main/install.sh | bash -s v2.1.0
# curl -fsSL https://raw.githubusercontent.com/user/pgx-goose/main/install.sh | bash -s latest ~/.local/bin
```

### 3.3 CLI Melhorada com UX Avan√ßada

**Interface de Linha de Comando Moderna:**
```bash
# Help contextual e interativo
pgx-goose --help
# üöÄ PGX-Goose v2.0 - PostgreSQL Code Generator for Go
# 
# USAGE:
#   pgx-goose [command] [flags]
# 
# COMMANDS:
#   generate   Generate Go repository code (default, backward compatible)
#   crud       Generate SQL CRUD operations
#   frontend   Generate TypeScript types and interfaces
#   constants  Generate Go and TypeScript constants
#   models     Transform and modify Go struct models
#   update     Check for updates and auto-update
#   init       Initialize new project with templates
#   validate   Validate configuration files
#   migrate    Migrate between PGX-Goose versions
# 
# FLAGS:
#   --config, -c     Configuration file (default: pgx-goose-conf.yaml)
#   --verbose, -v    Enable verbose output
#   --dry-run        Show what would be generated without writing files
#   --help, -h       Show help for command
#   --version        Show version information
# 
# EXAMPLES:
#   pgx-goose generate --dsn "postgres://..." --schema public
#   pgx-goose crud --config crud.yaml --tables users,orders
#   pgx-goose frontend --types api-types --output ./frontend/src/types
#   pgx-goose init --type webapp --name my-project
# 
# Get started: https://github.com/user/pgx-goose/docs/quick-start
# Issues: https://github.com/user/pgx-goose/issues

# Valida√ß√£o de configura√ß√£o
pgx-goose validate --config pgx-goose-conf.yaml
# ‚úÖ Configuration file: pgx-goose-conf.yaml
# ‚úÖ Database connection: postgresql://...
# ‚úÖ Output directories: writable
# ‚úÖ Templates: valid
# ‚ùå Warning: Table 'old_users' not found in schema
# ‚ùå Error: Invalid template syntax in model.tmpl:15
# 
# üìä Summary: 4 checks passed, 1 warning, 1 error

# Dry-run para preview
pgx-goose crud --config crud.yaml --dry-run
# üîç DRY RUN MODE - No files will be written
# 
# Would generate:
#   üìÅ sql/queries/users/
#     üìÑ create.sql     (126 lines)
#     üìÑ find_all.sql   (45 lines)
#     üìÑ find_by_id.sql (23 lines)
#     üìÑ update.sql     (67 lines)
#     üìÑ delete.sql     (12 lines)
#   üìÅ sql/queries/orders/
#     üìÑ create.sql     (89 lines)
#     üìÑ find_all.sql   (78 lines)
# 
# üìä Total: 8 files, 440 lines of SQL

# Inicializa√ß√£o de projeto interativa
pgx-goose init
# üöÄ Welcome to PGX-Goose v2.0!
# 
# Let's set up your new project:
# 
# üìÅ Project name: my-awesome-app
# üèóÔ∏è  Project type:
#   1. Web Application (Go + PostgreSQL + TypeScript)
#   2. API Service (Go + PostgreSQL only)
#   3. CLI Tool (Go + SQLite)
#   4. Microservice (Go + PostgreSQL + gRPC)
# 
# Choose [1-4]: 1
# 
# üóÑÔ∏è  Database:
#   üìç Host: localhost
#   üîå Port: 5432
#   üìä Database: my_awesome_app
#   üë§ Username: postgres
#   üîë Password: [hidden]
# 
# üß™ Test connection... ‚úÖ Connected!
# 
# üìù Generating project structure...
# ‚úÖ Created: ./my-awesome-app/
# ‚úÖ Created: ./my-awesome-app/go.mod
# ‚úÖ Created: ./my-awesome-app/pgx-goose-conf.yaml
# ‚úÖ Created: ./my-awesome-app/migrations/
# ‚úÖ Created: ./my-awesome-app/internal/
# ‚úÖ Created: ./my-awesome-app/frontend/
# 
# üéâ Project created successfully!
# 
# Next steps:
#   cd my-awesome-app
#   pgx-goose generate
#   go run main.go
```

### 3.4 Sistema de Logging e Debugging Avan√ßado

**Configura√ß√£o de Logs:**
```yaml
# pgx-goose-conf.yaml
logging:
  level: "info"                    # debug, info, warn, error
  format: "pretty"                 # pretty, json, logfmt
  output: "console"                # console, file, both
  file: "./logs/pgx-goose.log"
  
  # Configura√ß√µes espec√≠ficas
  components:
    database: "debug"              # Log detalhado de queries
    template: "info"               # Log de renderiza√ß√£o de templates
    generator: "warn"              # Apenas warnings/errors
    
  # Integra√ß√£o com ferramentas
  structured: true                 # Logs estruturados
  trace_requests: true             # Request tracing
```

**Sa√≠da de Log Melhorada:**
```bash
pgx-goose generate --verbose
# üîß [INFO] PGX-Goose v2.0.5 starting...
# üîå [INFO] Connecting to database: postgresql://localhost:5432/myapp
# üîç [DEBUG] Found tables: users(8 cols), orders(12 cols), products(15 cols)
# üìù [INFO] Loading templates from: ./templates_postgresql/
# ‚öôÔ∏è  [DEBUG] Processing template: model.tmpl
# ‚öôÔ∏è  [DEBUG] Processing template: repository_postgres.tmpl
# ‚úÖ [INFO] Generated: internal/generated/models/user.go (234 lines)
# ‚úÖ [INFO] Generated: internal/generated/repositories/user_repository.go (456 lines)
# üéâ [INFO] Generation completed in 1.2s
# 
# üìä Summary:
#   üìÑ Files generated: 18
#   üìù Lines of code: 3,247
#   ‚ö° Performance: 2,705 lines/second
#   üíæ Total size: 127.3 KB
```

**Benef√≠cios da Developer Experience:**
- üöÄ **Produtividade:** Setup de projeto em segundos
- üîÑ **Atualiza√ß√µes:** Sempre na vers√£o mais recente automaticamente
- üêõ **Debugging:** Logs detalhados para troubleshooting
- üí° **Usabilidade:** CLI intuitiva com help contextual
- üõ°Ô∏è **Seguran√ßa:** Verifica√ß√£o de integridade e assinatura digital
- üì¶ **Portabilidade:** Instala√ß√£o universal cross-platform

---

## üìñ IV. Exemplos Pr√°ticos de Uso

### üöÄ Uso B√°sico (Backward Compatible)
```bash
# Uso tradicional - ainda funciona 100%
pgx-goose --dsn "postgres://user:pass@localhost/db" \
          --schema "public" \
          --out "./generated"
```

### ‚ö° Uso Avan√ßado com Performance
```bash
# Gera√ß√£o paralela otimizada
pgx-goose --dsn "postgres://user:pass@localhost/db" \
          --schema "public" \
          --out "./generated" \
          --parallel \
          --workers 8 \
          --incremental \
          --optimize-templates
```

### üìÇ Estrutura Organizada
```bash
# Diret√≥rios separados para Clean Architecture
pgx-goose --config pgx-goose-conf.yaml \
          --models-dir "./internal/domain/entities" \
          --interfaces-dir "./internal/ports/repositories" \
          --repos-dir "./internal/adapters/db" \
          --mocks-dir "./tests/mocks" \
          --tests-dir "./tests/integration"
```

### üîó Cross-Schema com Relacionamentos
```bash
# M√∫ltiplos schemas com detec√ß√£o de relacionamentos
pgx-goose --dsn "postgres://user:pass@localhost/db" \
          --cross-schema \
          --config multi-schema-conf.yaml
```

### üõ†Ô∏è Integra√ß√£o Completa
```bash
# Setup completo com go:generate e migra√ß√µes
pgx-goose --config pgx-goose-conf.yaml \
          --go-generate \
          --generate-migrations \
          --template-dir "./custom-templates"
```

### üìã Exemplo de Configura√ß√£o Completa
```yaml
# pgx-goose-conf.yaml
dsn: "postgres://user:pass@localhost:5432/myapp?sslmode=disable"
schema: "public"

# Diret√≥rios organizados
output_dirs:
  base: "./generated"
  models: "./internal/domain/entities"
  interfaces: "./internal/ports/repositories"
  repositories: "./internal/adapters/db"
  mocks: "./tests/mocks"
  tests: "./tests/integration"

# Performance otimizada
parallel:
  enabled: true
  workers: 4

template_optimization:
  enabled: true
  cache_size: 100
  precompile: true

incremental:
  enabled: true
  force: false

# Cross-schema
cross_schema:
  enabled: true
  schemas: ["public", "analytics", "audit"]
  relationship_detection: true

# Integra√ß√µes
go_generate:
  enabled: true
  create_directive: true
  update_makefile: true

migrations:
  enabled: true
  output_dir: "./migrations"
  format: "goose"

# Op√ß√µes gerais
mock_provider: "mock"
with_tests: true
tables: []  # Todas as tabelas
ignore_tables:
  - "schema_migrations"
  - "goose_db_version"
```

### üìÅ Estrutura de Sa√≠da Gerada
```
generated/
‚îú‚îÄ‚îÄ internal/domain/entities/
‚îÇ   ‚îú‚îÄ‚îÄ user.go
‚îÇ   ‚îú‚îÄ‚îÄ order.go
‚îÇ   ‚îî‚îÄ‚îÄ product.go
‚îú‚îÄ‚îÄ internal/ports/repositories/
‚îÇ   ‚îú‚îÄ‚îÄ user_repository.go
‚îÇ   ‚îú‚îÄ‚îÄ order_repository.go
‚îÇ   ‚îî‚îÄ‚îÄ product_repository.go
‚îú‚îÄ‚îÄ internal/adapters/db/
‚îÇ   ‚îú‚îÄ‚îÄ user_repository_postgres.go
‚îÇ   ‚îú‚îÄ‚îÄ order_repository_postgres.go
‚îÇ   ‚îî‚îÄ‚îÄ product_repository_postgres.go
‚îú‚îÄ‚îÄ tests/mocks/
‚îÇ   ‚îú‚îÄ‚îÄ user_repository_mock.go
‚îÇ   ‚îú‚îÄ‚îÄ order_repository_mock.go
‚îÇ   ‚îî‚îÄ‚îÄ product_repository_mock.go
‚îú‚îÄ‚îÄ tests/integration/
‚îÇ   ‚îú‚îÄ‚îÄ user_repository_test.go
‚îÇ   ‚îú‚îÄ‚îÄ order_repository_test.go
‚îÇ   ‚îî‚îÄ‚îÄ product_repository_test.go
‚îú‚îÄ‚îÄ migrations/
‚îÇ   ‚îú‚îÄ‚îÄ 001_create_users.sql
‚îÇ   ‚îú‚îÄ‚îÄ 002_create_orders.sql
‚îÇ   ‚îî‚îÄ‚îÄ 003_create_products.sql
‚îî‚îÄ‚îÄ generate.go  # go:generate directives
```

---
